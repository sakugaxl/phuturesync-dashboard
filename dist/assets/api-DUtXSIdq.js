const i="/api";class c{baseUrl=i;async fetchWithAuth(t,a={}){const e=localStorage.getItem("auth_token"),o={"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`},...a.headers},n=await fetch(`${this.baseUrl}${t}`,{...a,headers:o});if(n.status===401)throw localStorage.removeItem("auth_token"),window.location.href="/login",new Error("Unauthorized");if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n}async fetchFinancialData(t){try{const e=await(await this.fetchWithAuth(`/financial?timeframe=${t}`)).json();return{financial:e.financial,expenses:e.expenses}}catch(a){throw console.error("Error fetching financial data:",a),new Error("Failed to fetch financial data")}}async getAnalytics(){try{return await(await this.fetchWithAuth("/analytics")).json()}catch(t){throw console.error("Error fetching analytics:",t),new Error("Failed to fetch analytics data")}}async getCampaigns(){try{return await(await this.fetchWithAuth("/campaigns")).json()}catch(t){throw console.error("Error fetching campaigns:",t),new Error("Failed to fetch campaigns")}}async getSocialInsights(){try{const a=await(await this.fetchWithAuth("/auth/instagram/insights?metric=impressions,reach,profile_views&period=day&metric_type=total_value")).json();return{impressions:a.data.find(e=>e.name==="impressions")?.total_value?.value||0,reach:a.data.find(e=>e.name==="reach")?.total_value?.value||0,profile_views:a.data.find(e=>e.name==="profile_views")?.total_value?.value||0}}catch(t){throw console.error("Error fetching social insights:",t),new Error("Failed to fetch social insights")}}async fetchMarketingData(t){try{return await(await this.fetchWithAuth(`/marketing?timeframe=${t}`)).json()}catch(a){throw console.error("Error fetching marketing data:",a),new Error("Failed to fetch marketing data")}}async fetchInsightsData(){try{return await(await this.fetchWithAuth("/insights")).json()}catch(t){throw console.error("Error fetching insights data:",t),new Error("Failed to fetch insights data")}}}const s=new c,h=async()=>await s.getAnalytics(),l=async r=>await s.fetchFinancialData(r),f=async r=>await s.fetchMarketingData(r),w=async()=>await s.fetchInsightsData();console.log("API Base URL:",i);export{s as a,l as b,f as c,w as d,h as f};
